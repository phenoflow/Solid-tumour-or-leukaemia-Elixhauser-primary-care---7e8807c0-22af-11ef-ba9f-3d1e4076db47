# David Metcalfe, James Masters, Antonella Delmestri, Andrew Judge, Daniel Perry, Cheryl Zogg, Belinda Gabbe, Matthew Costa, 2024.

import sys, csv, re

codes = [{"code":"B17y.00","system":"readv2"},{"code":"B50..00","system":"readv2"},{"code":"B223100","system":"readv2"},{"code":"B200100","system":"readv2"},{"code":"B114.00","system":"readv2"},{"code":"A789800","system":"readv2"},{"code":"B205.00","system":"readv2"},{"code":"B055100","system":"readv2"},{"code":"B130.00","system":"readv2"},{"code":"B011.00","system":"readv2"},{"code":"B213200","system":"readv2"},{"code":"B517200","system":"readv2"},{"code":"B471.00","system":"readv2"},{"code":"B105.00","system":"readv2"},{"code":"ZV10011","system":"readv2"},{"code":"B484.00","system":"readv2"},{"code":"B015.00","system":"readv2"},{"code":"B173.00","system":"readv2"},{"code":"142..00","system":"readv2"},{"code":"B481.00","system":"readv2"},{"code":"B4A0.00","system":"readv2"},{"code":"B142000","system":"readv2"},{"code":"B49..00","system":"readv2"},{"code":"B34..00","system":"readv2"},{"code":"B203.00","system":"readv2"},{"code":"B524100","system":"readv2"},{"code":"B543.00","system":"readv2"},{"code":"B545.00","system":"readv2"},{"code":"B241200","system":"readv2"},{"code":"B111.00","system":"readv2"},{"code":"B46..00","system":"readv2"},{"code":"ZV10512","system":"readv2"},{"code":"B002300","system":"readv2"},{"code":"ZV10416","system":"readv2"},{"code":"B513.00","system":"readv2"},{"code":"B34y.00","system":"readv2"},{"code":"B137.00","system":"readv2"},{"code":"B314.00","system":"readv2"},{"code":"B306100","system":"readv2"},{"code":"Byu5.00","system":"readv2"},{"code":"B302100","system":"readv2"},{"code":"B112.00","system":"readv2"},{"code":"B545100","system":"readv2"},{"code":"B307000","system":"readv2"},{"code":"B512000","system":"readv2"},{"code":"B002100","system":"readv2"},{"code":"B312400","system":"readv2"},{"code":"Byu9.00","system":"readv2"},{"code":"B340100","system":"readv2"},{"code":"B49y000","system":"readv2"},{"code":"B0z1.00","system":"readv2"},{"code":"B003300","system":"readv2"},{"code":"B021.00","system":"readv2"},{"code":"ZV10412","system":"readv2"},{"code":"B340.00","system":"readv2"},{"code":"B300.00","system":"readv2"},{"code":"B342.00","system":"readv2"},{"code":"B540.00","system":"readv2"},{"code":"B003200","system":"readv2"},{"code":"B503.00","system":"readv2"},{"code":"B42..00","system":"readv2"},{"code":"B212.00","system":"readv2"},{"code":"B440.00","system":"readv2"},{"code":"B081.00","system":"readv2"},{"code":"B45X.00","system":"readv2"},{"code":"B062000","system":"readv2"},{"code":"B22..00","system":"readv2"},{"code":"B453.00","system":"readv2"},{"code":"B33..15","system":"readv2"},{"code":"B300200","system":"readv2"},{"code":"B346.00","system":"readv2"},{"code":"B050.11","system":"readv2"},{"code":"ZV10513","system":"readv2"},{"code":"B4Ay000","system":"readv2"},{"code":"B051000","system":"readv2"},{"code":"B49y.00","system":"readv2"},{"code":"B35z000","system":"readv2"},{"code":"B305C00","system":"readv2"},{"code":"B224000","system":"readv2"},{"code":"B243.00","system":"readv2"},{"code":"B204.00","system":"readv2"},{"code":"B430211","system":"readv2"},{"code":"ZV10y13","system":"readv2"},{"code":"B18y700","system":"readv2"},{"code":"B343.00","system":"readv2"},{"code":"B490.00","system":"readv2"},{"code":"B0...00","system":"readv2"},{"code":"B508.00","system":"readv2"},{"code":"B304400","system":"readv2"},{"code":"B10y.00","system":"readv2"},{"code":"B480.00","system":"readv2"},{"code":"B51y000","system":"readv2"},{"code":"B13..00","system":"readv2"},{"code":"B331.00","system":"readv2"},{"code":"B18y.00","system":"readv2"},{"code":"ZV67700","system":"readv2"},{"code":"B304.00","system":"readv2"},{"code":"B00..00","system":"readv2"},{"code":"B07y.00","system":"readv2"},{"code":"B012.00","system":"readv2"},{"code":"B35z.00","system":"readv2"},{"code":"B300100","system":"readv2"},{"code":"B1z2.00","system":"readv2"},{"code":"B062200","system":"readv2"},{"code":"B441.00","system":"readv2"},{"code":"B062100","system":"readv2"},{"code":"B052.00","system":"readv2"},{"code":"B34y000","system":"readv2"},{"code":"B063.00","system":"readv2"},{"code":"B305.11","system":"readv2"},{"code":"B305100","system":"readv2"},{"code":"B350000","system":"readv2"},{"code":"B21..00","system":"readv2"},{"code":"B308.00","system":"readv2"},{"code":"B520200","system":"readv2"},{"code":"B311100","system":"readv2"},{"code":"B062.00","system":"readv2"},{"code":"Byu1.00","system":"readv2"},{"code":"B524W00","system":"readv2"},{"code":"B303200","system":"readv2"},{"code":"ZV67A00","system":"readv2"},{"code":"ZV10300","system":"readv2"},{"code":"B241300","system":"readv2"},{"code":"B524200","system":"readv2"},{"code":"B306200","system":"readv2"},{"code":"B170.00","system":"readv2"},{"code":"B225.00","system":"readv2"},{"code":"B494.00","system":"readv2"},{"code":"B300800","system":"readv2"},{"code":"B122.00","system":"readv2"},{"code":"B524.00","system":"readv2"},{"code":"B072.00","system":"readv2"},{"code":"B001000","system":"readv2"},{"code":"B0z2.00","system":"readv2"},{"code":"B430300","system":"readv2"},{"code":"B4A..11","system":"readv2"},{"code":"B540000","system":"readv2"},{"code":"B11y.00","system":"readv2"},{"code":"B222000","system":"readv2"},{"code":"B470.00","system":"readv2"},{"code":"B10..00","system":"readv2"},{"code":"B064000","system":"readv2"},{"code":"B210.00","system":"readv2"},{"code":"B031.00","system":"readv2"},{"code":"B104.00","system":"readv2"},{"code":"B300A00","system":"readv2"},{"code":"Byu8000","system":"readv2"},{"code":"B180100","system":"readv2"},{"code":"B004300","system":"readv2"},{"code":"B310500","system":"readv2"},{"code":"B002200","system":"readv2"},{"code":"B331000","system":"readv2"},{"code":"B2zy.00","system":"readv2"},{"code":"B12..00","system":"readv2"},{"code":"B541.00","system":"readv2"},{"code":"B48y200","system":"readv2"},{"code":"B106.00","system":"readv2"},{"code":"B550.00","system":"readv2"},{"code":"B313000","system":"readv2"},{"code":"B303000","system":"readv2"},{"code":"B131.00","system":"readv2"},{"code":"B162.00","system":"readv2"},{"code":"ZV10111","system":"readv2"},{"code":"B304300","system":"readv2"},{"code":"B18y100","system":"readv2"},{"code":"B223000","system":"readv2"},{"code":"B310100","system":"readv2"},{"code":"B312500","system":"readv2"},{"code":"B305A00","system":"readv2"},{"code":"B501000","system":"readv2"},{"code":"B21y.00","system":"readv2"},{"code":"B065.00","system":"readv2"},{"code":"B123.00","system":"readv2"},{"code":"B221100","system":"readv2"},{"code":"B4...00","system":"readv2"},{"code":"B332200","system":"readv2"},{"code":"B310400","system":"readv2"},{"code":"B151400","system":"readv2"},{"code":"B110111","system":"readv2"},{"code":"B120.00","system":"readv2"},{"code":"B491.00","system":"readv2"},{"code":"B040.00","system":"readv2"},{"code":"B0zy.00","system":"readv2"},{"code":"B18y400","system":"readv2"},{"code":"B142.00","system":"readv2"},{"code":"B516.00","system":"readv2"},{"code":"B311500","system":"readv2"},{"code":"Byu7100","system":"readv2"},{"code":"B313200","system":"readv2"},{"code":"B010.11","system":"readv2"},{"code":"B410000","system":"readv2"},{"code":"ZV10214","system":"readv2"},{"code":"BB02.00","system":"readv2"},{"code":"ZV10.00","system":"readv2"},{"code":"B180.00","system":"readv2"},{"code":"B411.00","system":"readv2"},{"code":"B060000","system":"readv2"},{"code":"B50y.00","system":"readv2"},{"code":"B334000","system":"readv2"},{"code":"ZV10415","system":"readv2"},{"code":"ByuB.00","system":"readv2"},{"code":"B005.00","system":"readv2"},{"code":"B073.00","system":"readv2"},{"code":"B222.00","system":"readv2"},{"code":"Byu2.00","system":"readv2"},{"code":"B053.00","system":"readv2"},{"code":"B0z..00","system":"readv2"},{"code":"B517000","system":"readv2"},{"code":"B113.00","system":"readv2"},{"code":"B242.00","system":"readv2"},{"code":"Byu0.00","system":"readv2"},{"code":"ZV10211","system":"readv2"},{"code":"B331200","system":"readv2"},{"code":"B54y.00","system":"readv2"},{"code":"B313100","system":"readv2"},{"code":"ZV10411","system":"readv2"},{"code":"B03y.00","system":"readv2"},{"code":"B524000","system":"readv2"},{"code":"B301.00","system":"readv2"},{"code":"B311200","system":"readv2"},{"code":"B442.00","system":"readv2"},{"code":"B054.00","system":"readv2"},{"code":"B48..00","system":"readv2"},{"code":"B1z1.00","system":"readv2"},{"code":"B303.00","system":"readv2"},{"code":"B53..00","system":"readv2"},{"code":"B201000","system":"readv2"},{"code":"B310300","system":"readv2"},{"code":"ZV10511","system":"readv2"},{"code":"B240.00","system":"readv2"},{"code":"B220100","system":"readv2"},{"code":"ZV10400","system":"readv2"},{"code":"B117.00","system":"readv2"},{"code":"B511.00","system":"readv2"},{"code":"B2z..00","system":"readv2"},{"code":"ZV10y15","system":"readv2"},{"code":"B070.00","system":"readv2"},{"code":"B310000","system":"readv2"},{"code":"B43..00","system":"readv2"},{"code":"B41..00","system":"readv2"},{"code":"B4A2.00","system":"readv2"},{"code":"BB01.00","system":"readv2"},{"code":"ZV10017","system":"readv2"},{"code":"B551.00","system":"readv2"},{"code":"B141.00","system":"readv2"},{"code":"B202.00","system":"readv2"},{"code":"B302000","system":"readv2"},{"code":"B517.00","system":"readv2"},{"code":"B308100","system":"readv2"},{"code":"B304100","system":"readv2"},{"code":"ZV10414","system":"readv2"},{"code":"ZV10500","system":"readv2"},{"code":"B05y.00","system":"readv2"},{"code":"B067.00","system":"readv2"},{"code":"B55..00","system":"readv2"},{"code":"B450100","system":"readv2"},{"code":"B221.00","system":"readv2"},{"code":"B050.00","system":"readv2"},{"code":"B003000","system":"readv2"},{"code":"B300B00","system":"readv2"},{"code":"B001.00","system":"readv2"},{"code":"B51..00","system":"readv2"},{"code":"B510400","system":"readv2"},{"code":"ZV10015","system":"readv2"},{"code":"B331100","system":"readv2"},{"code":"ZV10212","system":"readv2"},{"code":"B214.00","system":"readv2"},{"code":"B110000","system":"readv2"},{"code":"B515.00","system":"readv2"},{"code":"B515000","system":"readv2"},{"code":"B060.00","system":"readv2"},{"code":"B35..00","system":"readv2"},{"code":"B02..00","system":"readv2"},{"code":"B430.00","system":"readv2"},{"code":"B060100","system":"readv2"},{"code":"B124.00","system":"readv2"},{"code":"B496.00","system":"readv2"},{"code":"B6...00","system":"readv2"},{"code":"B303300","system":"readv2"},{"code":"ByuA300","system":"readv2"},{"code":"B150.00","system":"readv2"},{"code":"B22y.00","system":"readv2"},{"code":"B000000","system":"readv2"},{"code":"B102.00","system":"readv2"},{"code":"ZV10y12","system":"readv2"},{"code":"B180200","system":"readv2"},{"code":"B485.00","system":"readv2"},{"code":"B1...00","system":"readv2"},{"code":"B41y.00","system":"readv2"},{"code":"B18..00","system":"readv2"},{"code":"ZV10417","system":"readv2"},{"code":"B524300","system":"readv2"},{"code":"B307200","system":"readv2"},{"code":"B307100","system":"readv2"},{"code":"B200.00","system":"readv2"},{"code":"B315200","system":"readv2"},{"code":"B213300","system":"readv2"},{"code":"B224.00","system":"readv2"},{"code":"B101.00","system":"readv2"},{"code":"B497.00","system":"readv2"},{"code":"Byu2400","system":"readv2"},{"code":"B071.00","system":"readv2"},{"code":"B241000","system":"readv2"},{"code":"B030.00","system":"readv2"},{"code":"B300500","system":"readv2"},{"code":"B506.00","system":"readv2"},{"code":"B308200","system":"readv2"},{"code":"B300600","system":"readv2"},{"code":"B486.00","system":"readv2"},{"code":"B51y200","system":"readv2"},{"code":"B206.00","system":"readv2"},{"code":"B520000","system":"readv2"},{"code":"B517300","system":"readv2"},{"code":"B17..00","system":"readv2"},{"code":"B006.00","system":"readv2"},{"code":"B224100","system":"readv2"},{"code":"B304200","system":"readv2"},{"code":"B452.00","system":"readv2"},{"code":"B241.00","system":"readv2"},{"code":"B410.00","system":"readv2"},{"code":"B451.00","system":"readv2"},{"code":"B08..00","system":"readv2"},{"code":"B482.00","system":"readv2"},{"code":"B51y.00","system":"readv2"},{"code":"B410100","system":"readv2"},{"code":"B520100","system":"readv2"},{"code":"B01y.00","system":"readv2"},{"code":"B487.00","system":"readv2"},{"code":"B07..00","system":"readv2"},{"code":"B523.00","system":"readv2"},{"code":"B061.00","system":"readv2"},{"code":"B55y.00","system":"readv2"},{"code":"B020.00","system":"readv2"},{"code":"B45y.00","system":"readv2"},{"code":"B41y100","system":"readv2"},{"code":"B110.00","system":"readv2"},{"code":"B52W.00","system":"readv2"},{"code":"B056.00","system":"readv2"},{"code":"B138.00","system":"readv2"},{"code":"B11y100","system":"readv2"},{"code":"B013100","system":"readv2"},{"code":"B4A4.00","system":"readv2"},{"code":"ZV10112","system":"readv2"},{"code":"B300900","system":"readv2"},{"code":"B12y.00","system":"readv2"},{"code":"B100.00","system":"readv2"},{"code":"B010.00","system":"readv2"},{"code":"B18y200","system":"readv2"},{"code":"ByuC800","system":"readv2"},{"code":"B14..00","system":"readv2"},{"code":"B432.00","system":"readv2"},{"code":"B110100","system":"readv2"},{"code":"B6y..00","system":"readv2"},{"code":"B430000","system":"readv2"},{"code":"B47..00","system":"readv2"},{"code":"B305.12","system":"readv2"},{"code":"Byu7.00","system":"readv2"},{"code":"B44..00","system":"readv2"},{"code":"B171.00","system":"readv2"},{"code":"B310200","system":"readv2"},{"code":"B064100","system":"readv2"},{"code":"B44y.00","system":"readv2"},{"code":"B4A3.00","system":"readv2"},{"code":"B03..00","system":"readv2"},{"code":"Byu2300","system":"readv2"},{"code":"B161000","system":"readv2"},{"code":"B04..00","system":"readv2"},{"code":"B443.00","system":"readv2"},{"code":"B222100","system":"readv2"},{"code":"B003100","system":"readv2"},{"code":"B501.00","system":"readv2"},{"code":"B051100","system":"readv2"},{"code":"B431.00","system":"readv2"},{"code":"B504.00","system":"readv2"},{"code":"B524400","system":"readv2"},{"code":"B307.00","system":"readv2"},{"code":"B042.00","system":"readv2"},{"code":"ZV10y00","system":"readv2"},{"code":"B01..00","system":"readv2"},{"code":"B4Ay.00","system":"readv2"},{"code":"B306000","system":"readv2"},{"code":"B220.00","system":"readv2"},{"code":"B507100","system":"readv2"},{"code":"B495.00","system":"readv2"},{"code":"B134.00","system":"readv2"},{"code":"B04y.00","system":"readv2"},{"code":"B45y000","system":"readv2"},{"code":"B000.00","system":"readv2"},{"code":"B4y..00","system":"readv2"},{"code":"B31..00","system":"readv2"},{"code":"B340000","system":"readv2"},{"code":"B016.00","system":"readv2"},{"code":"B344.00","system":"readv2"},{"code":"B26..00","system":"readv2"},{"code":"B512.00","system":"readv2"},{"code":"B521.00","system":"readv2"},{"code":"B510500","system":"readv2"},{"code":"B347.00","system":"readv2"},{"code":"B492.00","system":"readv2"},{"code":"B111000","system":"readv2"},{"code":"B02y.00","system":"readv2"},{"code":"B066.00","system":"readv2"},{"code":"B06y.00","system":"readv2"},{"code":"B507.00","system":"readv2"},{"code":"B010000","system":"readv2"},{"code":"B48y000","system":"readv2"},{"code":"B313.00","system":"readv2"},{"code":"B41y000","system":"readv2"},{"code":"B160.00","system":"readv2"},{"code":"ZV10018","system":"readv2"},{"code":"B525.00","system":"readv2"},{"code":"B510000","system":"readv2"},{"code":"B083.00","system":"readv2"},{"code":"B52y.00","system":"readv2"},{"code":"B11..00","system":"readv2"},{"code":"ZV10y11","system":"readv2"},{"code":"B493.00","system":"readv2"},{"code":"B111100","system":"readv2"},{"code":"B003.00","system":"readv2"},{"code":"B315000","system":"readv2"},{"code":"B041.00","system":"readv2"},{"code":"B022.00","system":"readv2"},{"code":"B13y.00","system":"readv2"},{"code":"B311400","system":"readv2"},{"code":"B431000","system":"readv2"},{"code":"B001100","system":"readv2"},{"code":"B350100","system":"readv2"},{"code":"B18y300","system":"readv2"},{"code":"B161300","system":"readv2"},{"code":"B200000","system":"readv2"},{"code":"ZV10y16","system":"readv2"},{"code":"B211.00","system":"readv2"},{"code":"B140.00","system":"readv2"},{"code":"B121.00","system":"readv2"},{"code":"B011100","system":"readv2"},{"code":"B305.00","system":"readv2"},{"code":"B055000","system":"readv2"},{"code":"B545000","system":"readv2"},{"code":"B060200","system":"readv2"},{"code":"B064.00","system":"readv2"},{"code":"ZV67600","system":"readv2"},{"code":"B430100","system":"readv2"},{"code":"B500200","system":"readv2"},{"code":"B06..00","system":"readv2"},{"code":"B522.00","system":"readv2"},{"code":"B304000","system":"readv2"},{"code":"B175.00","system":"readv2"},{"code":"B510300","system":"readv2"},{"code":"B430200","system":"readv2"},{"code":"B350.00","system":"readv2"},{"code":"B071000","system":"readv2"},{"code":"Byu8.00","system":"readv2"},{"code":"B300C00","system":"readv2"},{"code":"B103.00","system":"readv2"},{"code":"B300700","system":"readv2"},{"code":"B521200","system":"readv2"},{"code":"B48y.00","system":"readv2"},{"code":"B4A1000","system":"readv2"},{"code":"ByuC000","system":"readv2"},{"code":"B161100","system":"readv2"},{"code":"B500000","system":"readv2"},{"code":"Byu6.00","system":"readv2"},{"code":"ZV10019","system":"readv2"},{"code":"B163.00","system":"readv2"},{"code":"ByuC100","system":"readv2"},{"code":"B412.00","system":"readv2"},{"code":"B544.00","system":"readv2"},{"code":"B14y.00","system":"readv2"},{"code":"B303100","system":"readv2"},{"code":"B312000","system":"readv2"},{"code":"B17y000","system":"readv2"},{"code":"B33..14","system":"readv2"},{"code":"B000100","system":"readv2"},{"code":"B305000","system":"readv2"},{"code":"B303400","system":"readv2"},{"code":"B308300","system":"readv2"},{"code":"B552.00","system":"readv2"},{"code":"B074.00","system":"readv2"},{"code":"B223.00","system":"readv2"},{"code":"B300000","system":"readv2"},{"code":"B311000","system":"readv2"},{"code":"B520.00","system":"readv2"},{"code":"B311300","system":"readv2"},{"code":"B48y100","system":"readv2"},{"code":"B345.00","system":"readv2"},{"code":"B172.00","system":"readv2"},{"code":"ZV10016","system":"readv2"},{"code":"B302.00","system":"readv2"},{"code":"B502.00","system":"readv2"},{"code":"B24..00","system":"readv2"},{"code":"B002.00","system":"readv2"},{"code":"B500100","system":"readv2"},{"code":"B450.00","system":"readv2"},{"code":"B43y.00","system":"readv2"},{"code":"B151200","system":"readv2"},{"code":"B300300","system":"readv2"},{"code":"B303500","system":"readv2"},{"code":"B302200","system":"readv2"},{"code":"B133.00","system":"readv2"},{"code":"B11y000","system":"readv2"},{"code":"B510100","system":"readv2"}];
REQUIRED_CODES = 1;
with open(sys.argv[1], 'r') as file_in, open('solid-tumour-or-leukaemia-elixhauser-primary-care-potential-cases.csv', 'w', newline='') as file_out:
    csv_reader = csv.DictReader(file_in)
    csv_writer = csv.DictWriter(file_out, csv_reader.fieldnames + ["solid-tumour-or-leukaemia-elixhauser-primary-care-mneoplasm---primary-identified"])
    csv_writer.writeheader();
    codes_identified = 0;
    for row in csv_reader:
        newRow = row.copy();
        for cell in row:
            # Iterate cell lists (e.g. codes)
            for item in re.findall(r'\(([^,]*)\,', row[cell]):
                if(item in list(map(lambda code: code['code'], codes))): codes_identified+=1;
                if(codes_identified>=REQUIRED_CODES):
                    newRow["solid-tumour-or-leukaemia-elixhauser-primary-care-mneoplasm---primary-identified"] = "CASE";
                    break;
            if(codes_identified>=REQUIRED_CODES): break;
        if(codes_identified<REQUIRED_CODES):
            newRow["solid-tumour-or-leukaemia-elixhauser-primary-care-mneoplasm---primary-identified"] = "UNK";
        codes_identified=0;
        csv_writer.writerow(newRow)
